@using DocViewer.Presentation.Models.Docs;
@model DocsViewModel
@{
    var currentSort = Model.Sort;
    var currentFilter = Model.Filter;
}

<div class="d-flex justify-content-between align-items-center mb-3">
    <div class="category-container">
        @foreach (var category in Model.Categories)
        {
            <a href="?filter=@category&sort=@currentSort" class="btn @(currentFilter == @category
                                                                ? "btn-primary"
                                                                : "btn-light")">@category</a>
        }
    </div>
    <div class="search-container">
        <div class="d-flex align-items-center">
            <form class="w-100 me-3">
                <input type="search" class="form-control" placeholder="Search..." aria-label="Search" spellcheck="false" data-ms-editor="true">
            </form>
        </div>
    </div>
</div>
<div class="table-responsive">
    <table class="table table-hover table-striped">
        <thead>
            <tr>
                <th><a href="?sort=@(Model.Sort == "DocId" ? "id_desc" : "DocId")&filter=@currentFilter">Doc Id</a></th>
                <th><a href="?sort=@(Model.Sort == "Category" ? "category_desc" : "Category")&filter=@currentFilter">Category</a></th>
                <th><a href="?sort=@(Model.Sort == "Title" ? "title_desc" : "Title")&filter=@currentFilter">Title</a></th>
                <th><a href="?sort=@(Model.Sort == "Author" ? "author_desc" : "Author")&filter=@currentFilter">Author</a></th>
                <th><a href="?sort=@(Model.Sort == "DateTime" ? "datetime_desc" : "DateTime")&filter=@currentFilter">DateTime</a></th>
            </tr>
        </thead>
        <tbody>
            <div id="doc-list-container">
                @foreach (var doc in Model.Board.GetDocs(currentSort, currentFilter))
                {
                    <tr class="clickable-row" data-doc-id="@doc.DocId">
                        <td>@doc.DocId</td>
                        <td>@doc.Category</td>
                        <td>@doc.Title</td>
                        <td>@doc.Author</td>
                        <td>@doc.FormatDateTime</td>
                    </tr>
                }
            </div>
        </tbody>
    </table>
</div>

<script src="/docs/5.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-p34f1UUtsS3wqzfto5wAAmdvj+osOnFyQFpp4Ua3gs/ZVWx6oOypYoCJhGGScy+8" crossorigin="anonymous"></script>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        var rows = document.querySelectorAll(".clickable-row");
        rows.forEach(function (row) {
            row.addEventListener("click", function () {
                var docId = this.getAttribute('data-doc-id');
                window.location.href = '@Url.Action("Doc", "Docs")/' + docId
            });
        });
    });
</script>
